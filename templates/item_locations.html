{% extends "base.html" %}

{% block title %}Item Locations - H&O Parcel Scans{% endblock %}

{% block extra_styles %}{% endblock %}

{% block content %}
    <h2>Item Location Rules</h2>
    <p style="margin-bottom: 20px; color: #666;">
      Set warehouse locations for items by matching SKUs or keywords. These locations will appear in the Pick and Pack page.
    </p>

    <div class="add-form">
      <h3>Add New Location Rule</h3>
      <form method="post" action="{{ url_for('add_location_rule') }}">
        <div class="form-row">
          <div class="form-group narrow">
            <label for="aisle">Aisle</label>
            <input type="text" name="aisle" id="aisle" required placeholder="A1">
          </div>
          <div class="form-group narrow">
            <label for="shelf">Shelf</label>
            <input type="text" name="shelf" id="shelf" required placeholder="B3">
          </div>
          <div class="form-group narrow">
            <label for="rule_type">Match By</label>
            <select name="rule_type" id="rule_type" required>
              <option value="sku">SKU</option>
              <option value="keyword">Keyword</option>
            </select>
          </div>
          <div class="form-group">
            <label for="rule_value">Value</label>
            <input type="text" name="rule_value" id="rule_value" required placeholder="SKU-12345 or 'Bracelet'">
          </div>
          <div class="form-group" style="flex: 0;">
            <button type="submit" class="add-btn">+ Add Rule</button>
          </div>
        </div>
      </form>
    </div>

    <table class="rules-table">
      <thead>
        <tr>
          <th>Aisle</th>
          <th>Shelf</th>
          <th>Rule Type</th>
          <th>Match Value</th>
          <th>Created</th>
          <th style="width: 100px;">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% if rules %}
          {% for rule in rules %}
            <tr>
              <td><strong>{{ rule.aisle }}</strong></td>
              <td><strong>{{ rule.shelf }}</strong></td>
              <td>
                <span class="rule-type-badge rule-type-{{ rule.rule_type }}">
                  {{ rule.rule_type }}
                </span>
              </td>
              <td style="font-family: monospace;">{{ rule.rule_value }}</td>
              <td>{{ rule.created_at.strftime('%Y-%m-%d %H:%M') if rule.created_at else 'â€”' }}</td>
              <td>
                <form method="post" action="{{ url_for('delete_location_rule') }}" style="display: inline;">
                  <input type="hidden" name="rule_id" value="{{ rule.id }}">
                  <button type="submit" class="delete-btn" onclick="return confirm('Delete this rule?')">Delete</button>
                </form>
              </td>
            </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="6" style="text-align: center; padding: 32px; color: #999;">
              No location rules configured yet. Add your first rule above!
            </td>
          </tr>
        {% endif %}
      </tbody>
    </table>
{% endblock %}
